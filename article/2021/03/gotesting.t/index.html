<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:xblzbjs]">
<meta name="description" content="å› ä½•è€Œç”Ÿâ“ æœ‰æ—¶æµ‹è¯•ç¨‹åºéœ€è¦åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œé¢å¤–çš„è®¾ç½®æˆ–æ‹†å¸ã€‚æœ‰æ—¶æµ‹è¯•è¿˜éœ€è¦æ§åˆ¶å“ªäº›ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸ºäº†æ”¯æŒè¿™äº›å’Œå…¶ä»–æƒ…å†µ, testing åŒ…æä¾›äº† TestMain å‡½æ•° :
func TestMain(m *testing.M) æœ‰ä»€ä¹ˆä½œç”¨ğŸ¤” å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸­åŒ…å«è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æµ‹è¯•å°†è°ƒç”¨ TestMain(m)ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚TestMain è¿è¡Œåœ¨ä¸» goroutine ä¸­ , å¯ä»¥åœ¨è°ƒç”¨ m.Run å‰ååšä»»ä½•è®¾ç½®å’Œæ‹†å¸ã€‚m. Runå°†è¿”å›å¯èƒ½ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º. å¦‚æœTestMainè¿”å›ï¼Œæµ‹è¯•åŒ…è£…å™¨å°†m.Runçš„ç»“æœä¼ é€’ç»™æ“ä½œç³»ç»Ÿé€€å‡ºå®ƒè‡ªå·±
è°ƒç”¨TestMainæ—¶ï¼Œflag.è§£æå°šæœªè¿è¡Œã€‚å¦‚æœTestMainä¾èµ–äºå‘½ä»¤è¡Œæ ‡å¿—ï¼ŒåŒ…æ‹¬æµ‹è¯•åŒ…çš„æ ‡å¿—ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è°ƒç”¨flag.è§£ææ˜ç¡®åœ°ã€‚å‘½ä»¤è¡Œæ ‡å¿—æ€»æ˜¯ç”±è¿è¡Œçš„æ—¶é—´æµ‹è¯•æˆ–åŸºå‡†å‡½æ•°æ¥è§£æ
å› æ­¤ï¼Œå½“æ‚¨éœ€è¦ä¸ºæµ‹è¯•æ‰§è¡Œä¸€äº›å…¨å±€è®¾ç½®/åˆ é™¤æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿
ä¸¾ä¸ªğŸŒ° ç®€å• // file name: demo_test.go package tests import ( &amp;#34;testing&amp;#34; &amp;#34;os&amp;#34; ) func TestMain(m *testing.M) { log.Println(&amp;#34;Do stuff BEFORE the tests!&amp;#34;) exitVal := m.Run() log.Println(&amp;#34;Do stuff AFTER the tests!&amp;#34;) os.Exit(exitVal) } func TestA(t *testing.T) { log.Println(&amp;#34;TestA running&amp;#34;) } func TestB(t *testing.T) { log.Println(&amp;#34;TestB running&amp;#34;) } è¾“å‡º $ go test -v demo_test." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://xblzbjs.cn/article/2021/03/gotesting.t/" />


    <title>
        
            Goï½œtesting.T :: è¡Œç™¾é‡Œè€…åŠä¹å 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://xblzbjs.cn/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://xblzbjs.cn/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://xblzbjs.cn/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://xblzbjs.cn/favicon-16x16.png">
    <link rel="manifest" href="https://xblzbjs.cn/site.webmanifest">
    <link rel="mask-icon" href="https://xblzbjs.cn/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://xblzbjs.cn/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Goï½œtesting.T">
<meta itemprop="description" content="å› ä½•è€Œç”Ÿâ“ æœ‰æ—¶æµ‹è¯•ç¨‹åºéœ€è¦åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œé¢å¤–çš„è®¾ç½®æˆ–æ‹†å¸ã€‚æœ‰æ—¶æµ‹è¯•è¿˜éœ€è¦æ§åˆ¶å“ªäº›ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸ºäº†æ”¯æŒè¿™äº›å’Œå…¶ä»–æƒ…å†µ, testing åŒ…æä¾›äº† TestMain å‡½æ•° :
func TestMain(m *testing.M) æœ‰ä»€ä¹ˆä½œç”¨ğŸ¤” å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸­åŒ…å«è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æµ‹è¯•å°†è°ƒç”¨ TestMain(m)ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚TestMain è¿è¡Œåœ¨ä¸» goroutine ä¸­ , å¯ä»¥åœ¨è°ƒç”¨ m.Run å‰ååšä»»ä½•è®¾ç½®å’Œæ‹†å¸ã€‚m. Runå°†è¿”å›å¯èƒ½ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º. å¦‚æœTestMainè¿”å›ï¼Œæµ‹è¯•åŒ…è£…å™¨å°†m.Runçš„ç»“æœä¼ é€’ç»™æ“ä½œç³»ç»Ÿé€€å‡ºå®ƒè‡ªå·±
è°ƒç”¨TestMainæ—¶ï¼Œflag.è§£æå°šæœªè¿è¡Œã€‚å¦‚æœTestMainä¾èµ–äºå‘½ä»¤è¡Œæ ‡å¿—ï¼ŒåŒ…æ‹¬æµ‹è¯•åŒ…çš„æ ‡å¿—ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è°ƒç”¨flag.è§£ææ˜ç¡®åœ°ã€‚å‘½ä»¤è¡Œæ ‡å¿—æ€»æ˜¯ç”±è¿è¡Œçš„æ—¶é—´æµ‹è¯•æˆ–åŸºå‡†å‡½æ•°æ¥è§£æ
å› æ­¤ï¼Œå½“æ‚¨éœ€è¦ä¸ºæµ‹è¯•æ‰§è¡Œä¸€äº›å…¨å±€è®¾ç½®/åˆ é™¤æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿
ä¸¾ä¸ªğŸŒ° ç®€å• // file name: demo_test.go package tests import ( &#34;testing&#34; &#34;os&#34; ) func TestMain(m *testing.M) { log.Println(&#34;Do stuff BEFORE the tests!&#34;) exitVal := m.Run() log.Println(&#34;Do stuff AFTER the tests!&#34;) os.Exit(exitVal) } func TestA(t *testing.T) { log.Println(&#34;TestA running&#34;) } func TestB(t *testing.T) { log.Println(&#34;TestB running&#34;) } è¾“å‡º $ go test -v demo_test."><meta itemprop="datePublished" content="2021-03-24T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-03-24T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="193"><meta itemprop="image" content="https://xblzbjs.cn"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://xblzbjs.cn"/>

<meta name="twitter:title" content="Goï½œtesting.T"/>
<meta name="twitter:description" content="å› ä½•è€Œç”Ÿâ“ æœ‰æ—¶æµ‹è¯•ç¨‹åºéœ€è¦åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œé¢å¤–çš„è®¾ç½®æˆ–æ‹†å¸ã€‚æœ‰æ—¶æµ‹è¯•è¿˜éœ€è¦æ§åˆ¶å“ªäº›ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸ºäº†æ”¯æŒè¿™äº›å’Œå…¶ä»–æƒ…å†µ, testing åŒ…æä¾›äº† TestMain å‡½æ•° :
func TestMain(m *testing.M) æœ‰ä»€ä¹ˆä½œç”¨ğŸ¤” å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸­åŒ…å«è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æµ‹è¯•å°†è°ƒç”¨ TestMain(m)ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚TestMain è¿è¡Œåœ¨ä¸» goroutine ä¸­ , å¯ä»¥åœ¨è°ƒç”¨ m.Run å‰ååšä»»ä½•è®¾ç½®å’Œæ‹†å¸ã€‚m. Runå°†è¿”å›å¯èƒ½ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º. å¦‚æœTestMainè¿”å›ï¼Œæµ‹è¯•åŒ…è£…å™¨å°†m.Runçš„ç»“æœä¼ é€’ç»™æ“ä½œç³»ç»Ÿé€€å‡ºå®ƒè‡ªå·±
è°ƒç”¨TestMainæ—¶ï¼Œflag.è§£æå°šæœªè¿è¡Œã€‚å¦‚æœTestMainä¾èµ–äºå‘½ä»¤è¡Œæ ‡å¿—ï¼ŒåŒ…æ‹¬æµ‹è¯•åŒ…çš„æ ‡å¿—ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è°ƒç”¨flag.è§£ææ˜ç¡®åœ°ã€‚å‘½ä»¤è¡Œæ ‡å¿—æ€»æ˜¯ç”±è¿è¡Œçš„æ—¶é—´æµ‹è¯•æˆ–åŸºå‡†å‡½æ•°æ¥è§£æ
å› æ­¤ï¼Œå½“æ‚¨éœ€è¦ä¸ºæµ‹è¯•æ‰§è¡Œä¸€äº›å…¨å±€è®¾ç½®/åˆ é™¤æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿
ä¸¾ä¸ªğŸŒ° ç®€å• // file name: demo_test.go package tests import ( &#34;testing&#34; &#34;os&#34; ) func TestMain(m *testing.M) { log.Println(&#34;Do stuff BEFORE the tests!&#34;) exitVal := m.Run() log.Println(&#34;Do stuff AFTER the tests!&#34;) os.Exit(exitVal) } func TestA(t *testing.T) { log.Println(&#34;TestA running&#34;) } func TestB(t *testing.T) { log.Println(&#34;TestB running&#34;) } è¾“å‡º $ go test -v demo_test."/>




    <meta property="og:title" content="Goï½œtesting.T" />
<meta property="og:description" content="å› ä½•è€Œç”Ÿâ“ æœ‰æ—¶æµ‹è¯•ç¨‹åºéœ€è¦åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œé¢å¤–çš„è®¾ç½®æˆ–æ‹†å¸ã€‚æœ‰æ—¶æµ‹è¯•è¿˜éœ€è¦æ§åˆ¶å“ªäº›ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸ºäº†æ”¯æŒè¿™äº›å’Œå…¶ä»–æƒ…å†µ, testing åŒ…æä¾›äº† TestMain å‡½æ•° :
func TestMain(m *testing.M) æœ‰ä»€ä¹ˆä½œç”¨ğŸ¤” å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸­åŒ…å«è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æµ‹è¯•å°†è°ƒç”¨ TestMain(m)ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚TestMain è¿è¡Œåœ¨ä¸» goroutine ä¸­ , å¯ä»¥åœ¨è°ƒç”¨ m.Run å‰ååšä»»ä½•è®¾ç½®å’Œæ‹†å¸ã€‚m. Runå°†è¿”å›å¯èƒ½ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º. å¦‚æœTestMainè¿”å›ï¼Œæµ‹è¯•åŒ…è£…å™¨å°†m.Runçš„ç»“æœä¼ é€’ç»™æ“ä½œç³»ç»Ÿé€€å‡ºå®ƒè‡ªå·±
è°ƒç”¨TestMainæ—¶ï¼Œflag.è§£æå°šæœªè¿è¡Œã€‚å¦‚æœTestMainä¾èµ–äºå‘½ä»¤è¡Œæ ‡å¿—ï¼ŒåŒ…æ‹¬æµ‹è¯•åŒ…çš„æ ‡å¿—ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è°ƒç”¨flag.è§£ææ˜ç¡®åœ°ã€‚å‘½ä»¤è¡Œæ ‡å¿—æ€»æ˜¯ç”±è¿è¡Œçš„æ—¶é—´æµ‹è¯•æˆ–åŸºå‡†å‡½æ•°æ¥è§£æ
å› æ­¤ï¼Œå½“æ‚¨éœ€è¦ä¸ºæµ‹è¯•æ‰§è¡Œä¸€äº›å…¨å±€è®¾ç½®/åˆ é™¤æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿
ä¸¾ä¸ªğŸŒ° ç®€å• // file name: demo_test.go package tests import ( &#34;testing&#34; &#34;os&#34; ) func TestMain(m *testing.M) { log.Println(&#34;Do stuff BEFORE the tests!&#34;) exitVal := m.Run() log.Println(&#34;Do stuff AFTER the tests!&#34;) os.Exit(exitVal) } func TestA(t *testing.T) { log.Println(&#34;TestA running&#34;) } func TestB(t *testing.T) { log.Println(&#34;TestB running&#34;) } è¾“å‡º $ go test -v demo_test." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xblzbjs.cn/article/2021/03/gotesting.t/" /><meta property="og:image" content="https://xblzbjs.cn"/><meta property="article:section" content="article" />
<meta property="article:published_time" content="2021-03-24T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-03-24T00:00:00&#43;00:00" /><meta property="og:site_name" content="è¡Œç™¾é‡Œè€…åŠä¹å" />






    <meta property="article:section" content="Golang" />



    <meta property="article:published_time" content="2021-03-24 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://xblzbjs.cn/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">è¡Œç™¾é‡Œè€…åŠä¹å</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://xblzbjs.cn/book-list">ä¹¦å•</a></li><li><a href="https://xblzbjs.cn/page/about/">å…³äº</a></li><li><a href="https://xblzbjs.cn/page/archives/">å½’æ¡£</a></li><li><a href="https://xblzbjs.cn/article">éšç¬”</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://xblzbjs.cn/article/2021/03/gotesting.t/">Goï½œtesting.T</a></h2>

            
            
            

            <div class="post-content">
                <h2 id="å› ä½•è€Œç”Ÿ">å› ä½•è€Œç”Ÿâ“</h2>
<p>æœ‰æ—¶æµ‹è¯•ç¨‹åºéœ€è¦åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿›è¡Œé¢å¤–çš„è®¾ç½®æˆ–æ‹†å¸ã€‚æœ‰æ—¶æµ‹è¯•è¿˜éœ€è¦æ§åˆ¶å“ªäº›ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œã€‚ä¸ºäº†æ”¯æŒè¿™äº›å’Œå…¶ä»–æƒ…å†µ, <code>testing</code> åŒ…æä¾›äº† <code>TestMain</code> å‡½æ•° :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestMain</span>(<span style="color:#a6e22e">m</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">M</span>)
</code></pre></div><h2 id="æœ‰ä»€ä¹ˆä½œç”¨">æœ‰ä»€ä¹ˆä½œç”¨ğŸ¤”</h2>
<p>å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸­åŒ…å«è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”Ÿæˆçš„æµ‹è¯•å°†è°ƒç”¨ <code>TestMain(m)</code>ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œæµ‹è¯•ã€‚<code>TestMain</code> è¿è¡Œåœ¨ä¸» goroutine ä¸­ , å¯ä»¥åœ¨è°ƒç”¨ <code>m.Run</code> å‰ååšä»»ä½•è®¾ç½®å’Œæ‹†å¸ã€‚<code>m. Run</code>å°†è¿”å›å¯èƒ½ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º. å¦‚æœTestMainè¿”å›ï¼Œæµ‹è¯•åŒ…è£…å™¨å°†m.Runçš„ç»“æœä¼ é€’ç»™æ“ä½œç³»ç»Ÿé€€å‡ºå®ƒè‡ªå·±</p>
<p>è°ƒç”¨TestMainæ—¶ï¼Œflag.è§£æå°šæœªè¿è¡Œã€‚å¦‚æœTestMainä¾èµ–äºå‘½ä»¤è¡Œæ ‡å¿—ï¼ŒåŒ…æ‹¬æµ‹è¯•åŒ…çš„æ ‡å¿—ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è°ƒç”¨flag.è§£ææ˜ç¡®åœ°ã€‚å‘½ä»¤è¡Œæ ‡å¿—æ€»æ˜¯ç”±è¿è¡Œçš„æ—¶é—´æµ‹è¯•æˆ–åŸºå‡†å‡½æ•°æ¥è§£æ</p>
<p>å› æ­¤ï¼Œå½“æ‚¨éœ€è¦ä¸ºæµ‹è¯•æ‰§è¡Œä¸€äº›å…¨å±€è®¾ç½®/åˆ é™¤æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿</p>
<h2 id="ä¸¾ä¸ª">ä¸¾ä¸ªğŸŒ°</h2>
<h3 id="ç®€å•">ç®€å•</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// file name: demo_test.go
</span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">tests</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;testing&#34;</span>
    <span style="color:#e6db74">&#34;os&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestMain</span>(<span style="color:#a6e22e">m</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">M</span>) {
    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Do stuff BEFORE the tests!&#34;</span>)
    <span style="color:#a6e22e">exitVal</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Run</span>()
    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Do stuff AFTER the tests!&#34;</span>)
    <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#a6e22e">exitVal</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestA</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;TestA running&#34;</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestB</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;TestB running&#34;</span>)
}
</code></pre></div><h4 id="è¾“å‡º">è¾“å‡º</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ go test -v demo_test.go
2021/03/24 11:01:06 Do stuff BEFORE the tests!
<span style="color:#f92672">===</span> RUN   TestA
2021/03/24 11:01:06 TestA running
--- PASS: TestA <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestB
2021/03/24 11:01:06 TestB running
--- PASS: TestB <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
PASS
2021/03/24 11:01:06 Do stuff AFTER the tests!
</code></pre></div><h3 id="å¤æ‚">å¤æ‚</h3>
<p>å‡è®¾åœ¨æµ‹è¯•ä¹‹å‰éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œä¸€äº›é…ç½®ï¼Œä¸ä½¿ç”¨<code>Testmain</code>å‡½æ•°å¯èƒ½éœ€è¦è¿™ä¹ˆå†™</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestDBFeatureA</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Setup</span>()
    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Exit</span>()

    <span style="color:#75715e">// Do the tests
</span><span style="color:#75715e"></span>}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestDBFeatureB</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Setup</span>()
    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Exit</span>()

    <span style="color:#75715e">// Do the tests
</span><span style="color:#75715e"></span>}
</code></pre></div><p>æœ‰äº†<code>Testmain</code>åï¼Œé…ç½®æ›´ä¸ºç®€å•æ¸…æ™°</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestDBFeatureA</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Reset</span>()

    <span style="color:#75715e">// Do the tests
</span><span style="color:#75715e"></span>}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestDBFeatureB</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Reset</span>()

    <span style="color:#75715e">// Do the tests
</span><span style="color:#75715e"></span>}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestMain</span>(<span style="color:#a6e22e">m</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">M</span>) {
    <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Setup</span>()
    <span style="color:#75715e">// os.Exit() does not respect defer statements
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">code</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Run</span>()
    <span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">TestDBManager</span>.<span style="color:#a6e22e">Exit</span>()
    <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#a6e22e">code</span>)
}
</code></pre></div><p>è™½ç„¶æ¯ä¸ªæµ‹è¯•éƒ½å¿…é¡»åœ¨è‡ªèº«å®Œæˆåè¿›è¡Œæ¸…ç†ï¼Œä½†è¿™åªæ¶‰åŠæ¢å¤åˆå§‹æ•°æ®ï¼Œè¿™æ¯”è¿›è¡Œæ¨¡å¼è¿ç§»è¦å¿«å¾—å¤šã€‚è¿™ç§æ–¹æ³•è¿˜å‡å°‘äº†ä»£ç é‡å¤ï¼Œåœ¨æ¯ä¸ªæµ‹è¯•ä¸­åªæœ‰ä¸€è¡Œç”¨äºæ•°æ®åº“ç®¡ç†ï¼Œè€Œä¸æ˜¯ä¸¤è¡Œï¼Œè¿è¡Œé€Ÿåº¦ä¼šå¿«å¾—å¤šã€‚</p>
<h2 id="æ³¨æ„">æ³¨æ„âš ï¸</h2>
<ul>
<li><code>testing.M</code>æœ‰ä¸€ä¸ªåä¸º<code>Runï¼ˆï¼‰</code>çš„å·²å®šä¹‰å‡½æ•°ï¼Œå®ƒè¿è¡ŒåŒ…ä¸­çš„æ‰€æœ‰æµ‹è¯•ã€‚<code>Runï¼ˆï¼‰</code>è¿”å›å¯ä»¥ä¼ é€’ç»™çš„é€€å‡ºä»£ç æ“ä½œç³»ç»Ÿé€€å‡º.</li>
<li>åœ¨ <code>TestMain</code> å‡½æ•°çš„æœ€åï¼Œåº”è¯¥ä½¿ç”¨ <code>m.Run</code> çš„è¿”å›å€¼ä½œä¸ºå‚æ•°å»è°ƒç”¨ <code>os.Exit</code>(è§å®˜æ–¹ä¾‹å­)ã€‚</li>
<li>å¦‚æœä¸è°ƒç”¨<code>os.Exit</code>ï¼Œé‚£æµ‹è¯•å‘½ä»¤å°†è¿”å›0ï¼ˆæµ‹è¯•å¤±è´¥ï¼‰</li>
<li>ç”±äºå‡½æ•°ååœ¨åŒ…ä¸­éœ€è¦å”¯ä¸€ï¼Œå› æ­¤åªèƒ½ä¸ºæ¯ä¸ªåŒ…å®šä¹‰ä¸€æ¬¡<code>TestMain</code>ã€‚å¦‚æœåŒ…ä¸‹æœ‰å¤šä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œæœ€å¥½åœ¨<code>TestMain</code>å‡½æ•°ä¸­è¿›è¡Œé€»è¾‘åˆ¤æ–­ã€‚</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“ğŸ“’</h2>
<p><code>TestMain</code>å‡½æ•°å¾ˆå¥½ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„åŒ…éƒ½éœ€è¦å®ç°<code>TestMain</code>ã€‚å¦‚æœå›¢é˜Ÿä½¿ç”¨ç¬¬ä¸‰æ–¹æµ‹è¯•æ¡†æ¶ä»…ä»…ç”¨åˆ°äº†è®¾ç½®å’Œæ‹†å¸åŠŸèƒ½ï¼Œè¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥è€ƒè™‘ç®€åŒ–ï¼Œç”¨goæä¾›çš„<code>TestMain</code>å‡½æ•°æ¥è¿›è¡Œé…ç½®ã€‚</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://xblzbjs.cn/categories/golang/">Golang</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">xblzbjs</a></span><span><a href="https://xblzbjs.cn/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>ç²¤ICPå¤‡2021007187å·-1</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://xblzbjs.cn/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js" integrity="sha512-LOZOpupEpysT3YEvwutcyj7&#43;h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-192697137-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



    </body>
</html>
